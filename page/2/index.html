<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Hank&#39;s House">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hank&#39;s House">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hank&#39;s House">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>Hank's House</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hank's House</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/20/node—网络操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/node—网络操作/" itemprop="url">node基础学习——网络操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-20T14:52:11+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>编写高性能web服务器</p>
<h4 id="http部分"><a href="#http部分" class="headerlink" title="http部分"></a>http部分</h4><p>req和res的梳理<br>均可直接访问头数据如req.method res.headers等；均可req.on(‘data’/‘end’,function(){})<br>一个实际的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//客户端 发送请求</span><br><span class="line">http.get(&apos;http://127.0.0.1:8080&apos;,function(res)&#123;</span><br><span class="line">    //http.request(&#123;hostname:&apos;&apos;,port:8080&#125;,function) post请求时可如此。Q：此例如此写无法执行，因为本地主机的原因？</span><br><span class="line">    var body = [];</span><br><span class="line">    res.on(&apos;data&apos;,(chunk)=&gt;&#123;</span><br><span class="line">       body.push(chunk);</span><br><span class="line">    &#125;);  //服务器返回的数据</span><br><span class="line">    res.on(&apos;end&apos;,()=&gt;&#123;</span><br><span class="line">        console.log(body.toString());//body本身输出是二进制buffer数组</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">//服务器端 </span><br><span class="line">http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    res.writeHead(200,&#123;&apos;Content-Type&apos;:&apos;text/plain&apos;&#125;);</span><br><span class="line">    res.write(&apos;hello&apos;);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;).listen(8080)</span><br></pre></td></tr></table></figure></p>
<h4 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>和http类似，只是多了额外的SSL证书配置。<br>//服务器端<br>var options = {<br>    key:fs.readFileSync(‘./ssl/default.key’), //服务器使用的私钥<br>    cert:fs.readFileSync(‘./ssl/default.cer’) //服务器使用的公钥<br>} //相比于http多了该参数<br>var server = https.creatServer(options,(req,res)=&gt;{</p>
<p>})<br>//SNI技术，即此服务器为多个域名提供服务<br>//添加不同域名证书<br>server.addContext(‘foo.com’,{<br>    key:…,<br>    cert:…<br>})<br>//客户端模式发起请求<br>https.request(options,(res)=&gt;{ //别和服务器的options混了，这里是请求头、主机端口等信息</p>
<p>})</p>
<h4 id="url"><a href="#url" class="headerlink" title="url"></a>url</h4><p><img src="/images/url.png" alt="&quot;&quot;"><br>url字符串：比如<a href="http://user:pass@host.com:8080/p/a/t/h?query=string#hash" target="_blank" rel="noopener">http://user:pass@host.com:8080/p/a/t/h?query=string#hash</a><br>url对象：每一部分拆解开<br>转换方式：url.parse(‘url字符串’) 转换成对象<br><em>parse的另外两个参数：参数二为true，query字段返回的不是字符串而是queryString处理后的参数对象；参数三为true，可正确解析不含协议头的url如’//<a href="http://www.baidu.com&#39;" target="_blank" rel="noopener">www.baidu.com&#39;</a></em><br>url.format(‘url对象’)  转换成url字符串<br>url.resolve(‘<a href="http://www.baidu.com&#39;,&#39;/hank&#39;" target="_blank" rel="noopener">www.baidu.com&#39;,&#39;/hank&#39;</a>) 拼接url（引申：path.join是拼接文件路径哦）</p>
<h4 id="queryString"><a href="#queryString" class="headerlink" title="queryString"></a>queryString</h4><p>url参数字符串和对象互相转换。解析url查询参数。<br>querystring.parse(‘foo=bar&amp;b=w’) 得{foo:bar,b:w}<br>querystring.stringify({})</p>
<h4 id="zlib模块"><a href="#zlib模块" class="headerlink" title="zlib模块"></a>zlib模块</h4><p>开启gzip压缩功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">//服务器端。压缩HTTP响应体数据发给客户端。判断客户端是否开启，再决定是否启用</span><br><span class="line">http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    //测试数据</span><br><span class="line">    var i = 1024,data=&apos;&apos;;</span><br><span class="line">    while(i--) &#123;</span><br><span class="line">        data += &apos;.&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    if((req.headers[&apos;accept-encoding&apos;]).indexOf(&apos;gzip&apos;)!==-1)&#123; //此处可以用正则表达式来写！</span><br><span class="line">        zlib.gzip(data,(err,data)&#123;</span><br><span class="line">        res.writeHead(200,&#123;</span><br><span class="line">            &apos;Content-Type&apos;:&apos;text/plain&apos;,</span><br><span class="line">            &apos;Content-Encoding&apos;:&apos;gzip&apos;  //accept-encoding和content-encoding</span><br><span class="line">        &#125;);</span><br><span class="line">        res.end(data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    //不设置gzip即可</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).listen(8080)</span><br><span class="line">//客户端。收到响应体数据进行解压缩。判断服务器端是否使用gzip，是的话进行解压</span><br><span class="line">var options = &#123;</span><br><span class="line">    ...</span><br><span class="line">    headers:&#123;</span><br><span class="line">        &apos;Accept-Encoding&apos;:&apos;gzip,deflate&apos; //两种压缩方式，服务器会根据这决定返回哪种压缩文件</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">http.request(options,(res)=&gt;&#123;</span><br><span class="line">    var body = [];</span><br><span class="line">    res.on(&apos;data&apos;,(chunk)=&gt;&#123;</span><br><span class="line">        body.push(chunk)</span><br><span class="line">    &#125;);</span><br><span class="line">    res.on(&apos;end&apos;,()=&gt;&#123;</span><br><span class="line">        body = Buffer.concat(body);</span><br><span class="line">        if(res.headers[&apos;Content-Encoding&apos;]===&apos;gzip&apos;)&#123; //或者switch(res.headers[&apos;content-encoding&apos;])判断是gzip or deflate等</span><br><span class="line">            zlib.gunzip(body,(err,data)&#123;</span><br><span class="line">                console.log(data.toString())</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            console.log(body)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="net模块"><a href="#net模块" class="headerlink" title="net模块"></a>net模块</h4><p>创建socket服务器或客户端。<br><em>socket协议是传输控制层的，websocket是应用层</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/19/node—文件操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/19/node—文件操作/" itemprop="url">node基础学习——文件操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-19T12:08:42+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>js是脚本语言，对于html中的js，浏览器作为解析器（运行环境）;对于单独的js,node作为解析环境。<br>浏览器中操作DOM，提供document等内置对象;NODEJS操作磁盘文件or搭建HTTP服务器，提供fs、http等内置对象。<br>所有模块执行过程中只初始化一次。</p>
<h4 id="模块路径："><a href="#模块路径：" class="headerlink" title="模块路径："></a>模块路径：</h4><p>1.内置模块直接调用如require(‘fs’)<br>2.node_modules目录下如某个绝对路径为’/home/user/h.js’的文件中require(‘foo/bar’)，则使用的路径依次为/home/user/node_modules/foo/bar或者/home/node_modules…或者/node_modules/…<br>3.NODE_PATH环境变量（尝试额外的搜索路径）</p>
<p>下载第三方数据包,可以先写入package.json,再npm insatall.</p>
<h4 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//异步拷贝</span><br><span class="line">fs.readFile(&apos;./t.txt&apos;, function(err, data) &#123;</span><br><span class="line">	if (err) &#123;</span><br><span class="line">		console.log(&apos;read fail!&apos;);</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		console.log(&apos;reading data...&apos;);</span><br><span class="line">        fs.writeFile(&apos;./tee.txt&apos;, data, function(err) &#123;</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                console.log(&apos;write fail!&apos;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                console.log(&apos;writing data...&apos;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">//同步复制</span><br><span class="line">/*function copy(src,dst) &#123; //源路径 目标路径</span><br><span class="line">    fs.writeFileSync(dst,fs.readFileSync(src)); //读取原路径写进来</span><br><span class="line">    &#125;</span><br><span class="line">    copy(&apos;./t.txt&apos;,&apos;./tee.txt&apos;);*/</span><br><span class="line">//或者fs.writeFileSync(&apos;./tee.txt&apos;,fs.readFileSync(&apos;./t.txt&apos;));</span><br><span class="line">//流stream</span><br><span class="line">//fs.createReadStream(&apos;./te.txt&apos;).pipe(fs.createWriteStream(&apos;./t.txt&apos;));</span><br><span class="line">//读取后流入到新文件中，适合大文件</span><br></pre></td></tr></table></figure>
<p>windows命令行复制文件：如将d:\1.jpg复制到f盘根目录——copy d:\1.jpg f:\1.jpg<br>所以可以在node中调用命令行实现文件复制：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var child_process = require(&apos;child_process&apos;);</span><br><span class="line">var util = require(&apos;util&apos;);</span><br><span class="line"></span><br><span class="line">function copy(source, target, callback) &#123;</span><br><span class="line">    child_process.exec(</span><br><span class="line">        util.format(&apos;copy %s %s&apos;, source, target), callback);// %s依次使用后面的字符串替换，所谓的格式化就是变量替换嘛</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">copy(&apos;C:\\Users\\hank.li\\Desktop\\hank\\s.png&apos;, &apos;C:\\Users\\hank.li\\Desktop&apos;, function (err) &#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">&#125;);</span><br><span class="line">//坑：双斜线防止转义啊！斜线方向要注意啊！</span><br><span class="line">//exec命令行开启执行子进程</span><br><span class="line">//spawn cluster</span><br></pre></td></tr></table></figure></p>
<h4 id="其他API："><a href="#其他API：" class="headerlink" title="其他API："></a>其他API：</h4><p><strong>buffer</strong>:处理二进制数据</p>
<p><strong>stream</strong>:内存一次装不下以及需要边读取边处理<br>var a = fs.createReadStream(pathname); //只读流<br>b = fs.createWriteStream(dst);<br>a.on(‘data’,function(chunk){b.write(chunk)})<br>a.on(‘end’,function(){b.end()})<br>基于事件机制的，stream实例继承自node中的eventEmitter<br>灵活使用回调，比如防止读取data太快导致后续函数处理不过来，可使用回调，即在处理函数前暂停读取，然后dosomething(chunk,function(){}).<br>最好加一步判断是否会爆仓（写入太慢读取太多），写入时a.on(‘data’,…)中判断b.write(chunk)===false,成立的话说明传入的数据放到缓存了还没写入目标，先暂停读取。另添加一个监听 b.on(‘drain’,function(){启动read})，drain事件用于判断缓存数据已写入目标。其实这与pipe实现很类似。(注意读写之间来不及处理的数据放在缓存中！)</p>
<p><strong>文件系统</strong>：关于fs模块。（此处展示node异步）<br>属性读写：stat(判断文件还是目录) chmod(异步方式改变文件读写权限) chown(更改文件所有权)<br>内容读写: readFile(异步读取) readdir(读取目录directory，返回包含所有文件和子目录的数组) writeFile mkdir(新建目录,fs.mkdir(‘./xxx’,function(err){}))<br>底层文件操作:open read write close<br>上述均为异步且都有同步方法。回调参数基本都有两个，错误+返回执行结果。</p>
<p><strong>Path</strong>:处理文件路径<br>normalize 标准化路径。实例：path.normalize(‘foo//baz//../bar’)得出foo/bar（多余斜杠会取消，..会回退上一级）<br>join 拼接路径。实例：path.join(‘foo/‘,’baz/‘,’../bar’)得出foo/bar<br>extname 返回扩展名，从最后一个.开始计算。如返回’.js’之类。</p>
<p><strong>遍历目录</strong><br>递归算法：简洁但是耗内存<br>遍历算法：树状结构目录，深度优先+先序遍历，即优先子集而非同级元素+首次到达某节点即遍历完成。<br>一个文件重命名demo：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//demo入口文件index.js放在test文件夹同级</span><br><span class="line">var counter = 9;</span><br><span class="line">fs.readdir(&apos;./test&apos;,function(err,files) &#123; //读取test文件夹中的所有txt文件</span><br><span class="line">    files.forEach(function(fn)&#123;</span><br><span class="line">        fs.renameSync(&apos;./test/&apos;+fn,&apos;./test/&apos;+counter+&apos;.txt&apos;);//fn只是test中的文件，重命名需加上目录。将前者重命名为后者（升序排列）。此处路径也是相对index文件所在目录</span><br><span class="line">        counter++;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><br>同步遍历：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//遍历index的同级文件夹</span><br><span class="line">function travel(dir,aa) &#123;</span><br><span class="line">    fs.readdirSync(dir).forEach(function(file)&#123;</span><br><span class="line">        var pathname = path.join(dir,file);//这里插入一个判断是目录还是文件（fs.statSync(pathname).isDirectory()），是目录的话就回调遍历函数。stat返回值是一个标志对象。</span><br><span class="line">        aa(pathname);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">travel(&apos;./&apos;,function aa(pathname)&#123;</span><br><span class="line">    console.log(pathname)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>异步遍历：略。<br><strong>文本编码</strong><br>常用文本编码主要是GBK（国家编码，包含全部中文字符）和UTF-8（国际编码）。二者之间通过unicode编码进行转换。<br>BOM 隐藏字符（UTF-8允许含BOM）<br>读取文本文件需去BOM，即：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function read(pathname) &#123;</span><br><span class="line">    var bin = fs.readFileSync(pathname);//返回一个字符串（buffer二进制数据），如果声明encoding则返回普通字符串（添加第2个参数&#123;encoding:&apos;utf-8&apos;）</span><br><span class="line">    if(bin[0]===0xEF &amp;&amp; bin[1]===0xBB &amp;&amp; bin[2]===0xBF) &#123;</span><br><span class="line">        bin = bin.slice(3);//BOM被去除</span><br><span class="line">    &#125;</span><br><span class="line">    return bin.toString(&apos;utf8&apos;);//转换成utf8编码（测试过转为汉字）</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>字符编码参考网站：<a href="https://www.cnblogs.com/xiaomia/archive/2010/11/28/1890072.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaomia/archive/2010/11/28/1890072.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/18/未分类知识点散记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/18/未分类知识点散记/" itemprop="url">未分类知识点散记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-18T12:08:42+08:00">
                2018-03-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="export、exports、export-default"><a href="#export、exports、export-default" class="headerlink" title="export、exports、export default"></a>export、exports、export default</h4><p>require    node和es6均支持<br>export/import   es6支持<br>module.exports/exports  node支持 （均指向某内存块{}，就用exports.xx = xx就好）</p>
<p>关于export和export default：<br>后者每个模块只有一个;前者可直接导出变量表达式。<br>前者（导出变量or方法）:<br>export const a = 100 或者 export const b = function(){}<br>或者<br>function xxx(){}<br>export { xxx };<br>后者:<br>const c = 100;<br>export default c;<br>前者导出的在导入时要加{},import { b } from ‘./…’<br>而export default则不用,import c from ‘./…’</p>
<p>import <em> as ObjectX from ‘./…’ 将零散的export导出为对象，而export default 是导出为default属性。<br>（吐槽：default只有一个肯定无所谓对象什么啦！soObjectX.c 不存在的。由于每个模块就一个default，所以ObjectX.default即可。）<br>ObjectX.b();执行函数b<br>（Q：引入多个模块均由export default怎么办？）
</em>参考地址：<a href="https://segmentfault.com/a/1190000010426778" target="_blank" rel="noopener">https://segmentfault.com/a/1190000010426778</a>*</p>
<h4 id="WebP格式"><a href="#WebP格式" class="headerlink" title="WebP格式"></a>WebP格式</h4><p>有损 无损 有损带透明<br>相比于jpg、png等格式，压缩效果更好，体积减小。<br>对比图：<br><img src="/images/webP.jpg" alt="&quot;&quot;"><br><em>参考地址：<a href="https://www.zhihu.com/question/27201061" target="_blank" rel="noopener">https://www.zhihu.com/question/27201061</a></em></p>
<h4 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h4><p>SNI 服务器名称指示。同IP下多域名虚拟主机的SSL/TLS认证。<br>正常客户端发起SSL握手请求时不包含host主机头信息，也就不知道该引向哪个域名（（http协议就有hostname）。而SSI会提交Host信息，使得服务器可以切换到正确的域并返回相应的证书。</p>
<h4 id="node安装"><a href="#node安装" class="headerlink" title="node安装"></a>node安装</h4><p>环境变量配置：计算机属性=&gt;高级系统设置=&gt;环境变量=&gt;PATH<br>修改node文件夹下的.npmrc文件，以设置npm全局安装位置（默认是在appdata里的）</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/15/vue-留言板+localStorage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/15/vue-留言板+localStorage/" itemprop="url">vue-留言板+localStorage+node后台留言板</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-15T10:08:42+08:00">
                2018-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>提交留言后显示在当前界面，存储在本地localStorage，保证下次加载不丢失。<br>重要知识点：localStorage的使用。</p>
<h4 id="前端留言板"><a href="#前端留言板" class="headerlink" title="前端留言板"></a>前端留言板</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//html部分，注意显示留言循环调用数组即可</span><br><span class="line">    &lt;p&gt;内容：</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;msg&quot; v-model=&quot;newMsg&quot;&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">   &lt;input type=&quot;button&quot; value=&quot;提交&quot; @click=&quot;addMsg&quot;&gt;</span><br><span class="line">        &lt;button @click=&quot;removeMsg&quot;&gt;清除&lt;/button&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &lt;li v-for=&quot;msg in msgs&quot;&gt;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//localStorage部分,封装起来统一使用</span><br><span class="line">var STORAGE = &apos;liuyanban&apos;;//设定一个存储空间，只是为了方便。不然就得localStorage.setItem(&apos;liuyanban&apos;,&apos;xxx&apos;),其中xxx为数组或对象，但需要做字符串转化处理。</span><br><span class="line">var msgStorage = &#123;</span><br><span class="line">    save(msgs) &#123;  //有msgs变化即调用存储</span><br><span class="line">        localStorage.setItem(STORAGE,JSON.stringify(msgs));//必须转化为字符串！</span><br><span class="line">    &#125;,</span><br><span class="line">    fetch() &#123;</span><br><span class="line">        var msgs = JSON.parse(localStorage.getItem(STORAGE));//msgs直接存入localStorage,显示的话调用localStorage中的msgs</span><br><span class="line">        return msgs;</span><br><span class="line">    &#125;,</span><br><span class="line">    clear() &#123;  //清除localStorage</span><br><span class="line">        localStorage.removeItem(STORAGE)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//调用存储部分</span><br><span class="line">data:&#123;msgs:msgStorage.fetch()&#125;</span><br><span class="line">watch:&#123;</span><br><span class="line">    msgs:&#123;</span><br><span class="line">        handle(msgs)&#123;</span><br><span class="line">            msgStorage.save(msgs)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">methods:&#123;</span><br><span class="line">    addMsg()&#123;</span><br><span class="line">        if(this.newMsg === &quot;&quot;) return;</span><br><span class="line">        this.msgs.push(&#123;title:this.newMsg&#125;) //msgs有变化，故调用save存储</span><br><span class="line">    &#125;,</span><br><span class="line">    removeMsg()&#123;  //清理显示和localStorage两部分</span><br><span class="line">        this.msgs = [];</span><br><span class="line">        msgStorage.clear(); //如果调用localStorage就全部清除了= =</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="关于localStorage"><a href="#关于localStorage" class="headerlink" title="关于localStorage"></a>关于localStorage</h4><p>存储路径在C:/用户/AppData下面。<br>chrome分配存储空间5M，整个子域共享,即<a href="http://www.baidu.com/下的任何域名都共享该空间。" target="_blank" rel="noopener">www.baidu.com/下的任何域名都共享该空间。</a><br>常用的基本就是上述使用的API：<br>setItem getItem removeItem  :key value<br>length<br>key(i) 获取第i个数据的key<br>clear(清除全部存储数据,剩余的只有这几个API)<br>清除后看了下自己电脑控制台：<br><img src="/images/localStorage.png" alt="&quot;&quot;"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for(var i in localStorage) &#123;</span><br><span class="line">    console.log(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>另，统计界面刷新次数也可以使用这，每次重载innerHTML写入时getItem后数字加1即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(!localStorage.getItem(&apos;number&apos;)) &#123;localStorage.setItem()&#125;</span><br><span class="line">localStorage.number = parseInt(localStorage.getItem(&apos;number&apos;)) + 1;</span><br><span class="line">console.log(localStorage.number);</span><br></pre></td></tr></table></figure></p>
<h4 id="node服务器端留言板"><a href="#node服务器端留言板" class="headerlink" title="node服务器端留言板"></a>node服务器端留言板</h4><p>require模块：http url querystring<br>俩路径通过pathname判断。<br>/message<br>写入form表单，即res.write(form)<br>/messageok<br>写入form中输入的文本，即<br>req.on(‘data’,(chunk)=&gt;{<br>    body += chunk;<br>})<br>req.on(‘end’,()=&gt;{<br>    console.log(qs.parse(body));<br>    res.end(‘over’); //网页显示over，命令行显示提交的内容<br>})</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/12/node练习-上传图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/12/node练习-上传图片/" itemprop="url">node-上传图片练习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-12T17:08:42+08:00">
                2018-03-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>keywords：formidable模块  multipart/form-data格式（content-type类型）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">//index.js</span><br><span class="line">//根文件，服务器启动，准备解析相应url</span><br><span class="line">var server = require(&quot;./server&quot;);</span><br><span class="line">var router = require(&apos;./router&apos;);</span><br><span class="line">var requestHandlers = require(&apos;./requestHandlers&apos;)</span><br><span class="line"></span><br><span class="line">var handle = &#123;&#125;;</span><br><span class="line">handle[&quot;/&quot;] = requestHandlers.start;</span><br><span class="line">handle[&quot;/start&quot;] = requestHandlers.start;</span><br><span class="line">handle[&quot;/upload&quot;] = requestHandlers.upload;</span><br><span class="line">handle[&quot;/show&quot;] = requestHandlers.show;</span><br><span class="line"></span><br><span class="line">server.start(router.route, handle);</span><br></pre></td></tr></table></figure> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">//server.js</span><br><span class="line">//监听8888端口，路由跳转</span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function start(route, handle) &#123;</span><br><span class="line">    function onRequest(req, res) &#123;</span><br><span class="line">        if (req.url === &quot;/favicon.ico&quot;) return; </span><br><span class="line">        //屏蔽浏览器favicon，这玩意就是标签页顶显示的那个小图标,否则刷新页面会出现两次路径</span><br><span class="line">        &lt;!--关于favicon图标，要么直接扔到根目录，要么head里设置如下</span><br><span class="line">       &lt;link rel=&quot;shortcut icon&quot; href=&quot;/favicon.ico&quot; type=&quot;image/x-icon&quot; /&gt; //这里保证IE兼容性  </span><br><span class="line">        //&lt;link rel=&quot;icon&quot; href=&quot;/favicon.ico&quot; sizes=&quot;32x32&quot; /&gt;    </span><br><span class="line">        //网站图标缓存，尽量不要超过16kb吧。32*32一般也就4kb--&gt;</span><br><span class="line">        console.log(&apos;received&apos;);</span><br><span class="line">        var pathname = url.parse(req.url).pathname; //解析req.url</span><br><span class="line">        route(handle,pathname,req,res);</span><br><span class="line">    &#125;</span><br><span class="line">    http.createServer(onRequest).listen(8888);</span><br><span class="line">    console.log(&apos;start&apos;);</span><br><span class="line">&#125;</span><br><span class="line">exports.start = start;</span><br><span class="line">/*var postData = &quot;&quot;;   这部分是读取文件测试     </span><br><span class="line">req.setEncoding(&quot;utf8&quot;);</span><br><span class="line">        req.addListener(&quot;data&quot;, function(chunk) &#123;</span><br><span class="line">            postData += chunk;</span><br><span class="line">            console.log(chunk);</span><br><span class="line">        &#125;);</span><br><span class="line">        req.addListener(&quot;end&quot;, function() &#123;</span><br><span class="line">            route(pathname, handle, res, postData);</span><br><span class="line">        &#125;)*/ </span><br></pre></td></tr></table></figure> 
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">//router.js</span><br><span class="line">//路径无效404处理，有效开始分配事件处理程序</span><br><span class="line">function route(handle,pathname,req,res) &#123;</span><br><span class="line">    if (typeof handle[pathname] === &apos;function&apos;) &#123;</span><br><span class="line">        handle[pathname](res.req);//注意req在前?总是提示“res.writeHead not a function”的坑，只能各个文件轮流更改参数顺序了</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        res.writeHead(404, &#123; &quot;Content-Type&quot;: &quot;text/html&quot; &#125;);</span><br><span class="line">        res.write(&quot;404&quot;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">exports.route = route;</span><br></pre></td></tr></table></figure> 
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">//requestHandlers.js</span><br><span class="line">//事件处理程序，针对不同路由</span><br><span class="line">var exec = require(&apos;child_process&apos;).exec; //注意没()</span><br><span class="line">var querystring = require(&apos;querystring&apos;),fs = require(&quot;fs&quot;),</span><br><span class="line">formidable = require(&apos;formidable&apos;);</span><br><span class="line"></span><br><span class="line">function start(res) &#123;</span><br><span class="line">    /*function sleep(sec) &#123;</span><br><span class="line">        let now = new Date().getTime();</span><br><span class="line">        while (new Date().getTime() &lt; now + sec);</span><br><span class="line">        /*let now = new Date(),exitTime = startTime.getTime()+sec;</span><br><span class="line">         while (true) &#123;</span><br><span class="line">             now = new Date();</span><br><span class="line">             if (now.getTime() &gt;  exitTime)</span><br><span class="line">                 return;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sleep(10000);*/</span><br><span class="line">    /*var content = &quot;empty&quot;;</span><br><span class="line">    exec(&quot;ca.txt&quot;, function(error, stdout, stderr) &#123;*/</span><br><span class="line">    var body = &apos;&lt;html&gt;&apos; +</span><br><span class="line">        &apos;&lt;head&gt;&apos; +</span><br><span class="line">        &apos;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; &apos; +</span><br><span class="line">        &apos;charset=UTF-8&quot; /&gt;&apos; +</span><br><span class="line">        &apos;&lt;/head&gt;&apos; +</span><br><span class="line">        &apos;&lt;body&gt;&apos; +</span><br><span class="line">        &apos;&lt;form action=&quot;/upload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;&apos; +</span><br><span class="line">        &apos;&lt;input type=&quot;file&quot; name=&quot;upload&quot;&gt;&apos; +</span><br><span class="line">        &apos;&lt;input type=&quot;submit&quot; value=&quot;Upload file&quot;&quot;/&gt;&apos; +            //判断是否提交， onchange=&quot;alert(this.value)或者判断value是否为空？实际就是表单验证</span><br><span class="line">        &apos;&lt;/form&gt;&apos; +</span><br><span class="line">        &apos;&lt;/body&gt;&apos; +</span><br><span class="line">        &apos;&lt;/html&gt;&apos;;</span><br><span class="line">    res.writeHead(200, &#123; &quot;Content-Type&quot;: &quot;text/html;charset=utf-8&quot; &#125;);</span><br><span class="line">    res.write(body); //写入相应路径的返回值</span><br><span class="line">    res.end(); //直接打开相应文件了</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">function upload(res, req) &#123;</span><br><span class="line">    var form = new formidable.IncomingForm();</span><br><span class="line">    form.parse(req,function(err,fields,files)&#123;</span><br><span class="line">        fs.renameSync(files.upload.path,&quot;./tmp/2.jpg&quot;);//重命名为右侧</span><br><span class="line">        res.writeHead(200, &#123; &quot;Content-Type&quot;: &quot;text/html;charset=utf-8&quot; &#125;);</span><br><span class="line">        res.write(&quot;&lt;img src=&apos;/show&apos;&gt;&quot;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function show(res)&#123;</span><br><span class="line">fs.readFile(&quot;./tmp/2.jpg&quot;,&quot;binary&quot;,function(err,file)&#123;</span><br><span class="line">    if(err)&#123;</span><br><span class="line">        res.writeHead(500, &#123; &quot;Content-Type&quot;: &quot;text/plain;charset=utf-8&quot; &#125;);</span><br><span class="line">        res.write(err+&quot;\n&quot;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        res.writeHead(200, &#123; &quot;Content-Type&quot;: &quot;image/jpg&quot; &#125;);</span><br><span class="line">        res.write(file,&quot;binary&quot;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">exports.start = start;</span><br><span class="line">exports.upload = upload;</span><br><span class="line">exports.show = show;</span><br></pre></td></tr></table></figure> 

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/11/各种名字随手记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/11/各种名字随手记/" itemprop="url">各种名词随手记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-11T10:08:42+08:00">
                2018-03-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>####git &amp; github<br>merge 合并（git合并分支）</p>
<p>####设计模式<br>MVC：model view controller。单向流，view中触发DOM事件，controller触发数据更新，model将数据显示到view中。（也可直接向controller发送指令，如改变url触发hashChange事件）<br>MVP：presenter。双向通信。隔绝V和M之间的通信，减少维护对象数量。<br>MVVM：ViewModel。类似于MVP。但是M和VM之间数据绑定进行双向交互。观察者/数据劫持。<br><img src="/images/MVC.png" alt="&quot;&quot;"><br><img src="/images/MVP.png" alt="&quot;&quot;"><br><img src="/images/MVVM.png" alt="&quot;&quot;">  </p>
<p>C/S模式：客户机/服务器<br>B/S模式：浏览器/服务器</p>
<p><strong>前后端分离：</strong><br>团队分工更细，后端只提供接口，前端可自己mock数据，负责页面展现接口设计和功能页面开发。<br><em>开发流程图：</em><br><img src="/images/frontend.png" alt="&quot;&quot;"><br><em>过程性文档：</em><br>接口契约文档：前端提出的定义前后端的接口定义。责任方：前端；评审方：后端、测试QA、产品<br>集成测试用例文档<br>功能测试用例完档：定义验收页面功能的用例。责任方：测试QA；评审方：前端、产品<br>单元测试用例：定义后端各个功能模块的单元用例。<br><em>技术框架选型</em><br><em>项目管理：</em><br>前端团队进度：基于mock接口三个阶段——一是跑通所有界面的mock接口（发现接口调用、css等各种问题）；二是基于所有页面进行迭代，问题统一解决，抽离公共组建进行优化界面；三是分批接入后端模块并提交QA进行功能测试。<br>参考网站：<a href="http://www.infoq.com/cn/articles/practice-frontend-backend-separation" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/practice-frontend-backend-separation</a></p>
<h4 id="计算机基础"><a href="#计算机基础" class="headerlink" title="计算机基础"></a>计算机基础</h4><p>四个时代：电子管 晶体管 集成电路 大规模集成电路<br><em>进制转换：</em><br>十进制小数到二进制小数——乘2取整法，从上到下读。如0.6875<em>2 = 1.375 取1，继续0.375</em>2类推。<br><em>信息编码：</em><br>BCD码（8421编码）——4 === 0100<br>ASCII码 ——通用7位版本<br>汉字编码<br>（国标码GB2312-80 区位码（94<em>94，一行为区，一列为位。所以共94个区，每个区内94个位的汉字字符集，有唯一的位置编码即区位码））<br>（机内码）<br>（汉字字形码）
</em>计算机组成：*<br>运算器 控制器 存储器 输入输出设备<br>存储器：内存、外存（硬盘光盘等）<br><img src="/images/pc.png" alt="&quot;&quot;"><br>多核CPU：一个CPU上有多个计算引擎（核心处理器）【单线程用不了】<br>多个CPU：一个主板上搞了几个CPU，通过总线进行通信</p>
<p>进程：操作系统进行资源分配的最小单元；线程：进程内部的一个执行单元<br>进程创建后，即启动主线程比如main函数之类。主线程中止，进程即中止。<br>多线程要注意的是资源共享，即两个线程同时访问一个资源，只能在使用时共享资源处于锁定状态。一个线程一个线程的来执行。</p>
<p>node执行某js文件，创建的是进程，但可能包含多个线程，但一次只执行一个线程（所谓的node单线程）。好处就是不用像java等多线程语言一样注意死锁、状态同步、上下文切换开销等。</p>
<p>CPU主频（MHz）高，微机运算速度快<br>RAM(随机/运行内存，断电就没)  ROM（只读内存相当于手机的硬盘存放安卓系统、软件、文件等） 快存（高速缓存存储器）<br>操作系统（OS）：单用户操作系统（多任务，windows）、分时操作系统（unix）等<br>语言编译程序：机器语言 汇编语言 高级语言</p>
<p>localStorage适合存储不需要和后台交互的，比如有些草稿功能，关闭界面再进入仍然有效。<br>cookie中可放语言设置等。浏览器进行实现和管理。<br>域domain 路径（同一目录和子目录下才OK）<br>类型：浏览网站本身设置、网页嵌入广告用于跟踪使用信息</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/09/git实践问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/09/git实践问题/" itemprop="url">git学习笔记&实践问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-09T12:08:42+08:00">
                2018-03-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###git学习笔记<br><img src="/images/git1.png" alt="&quot;&quot;"><br><img src="/images/git2.png" alt="&quot;&quot;"><br><img src="/images/git3.png" alt="&quot;&quot;"><br>分支管理：要提交没写完的代码使自己下次继续，需要创建一个自己的分支，别人看不到，在自己的分支上工作，开发完毕后再合并到原来的分支上。<br><img src="/images/git4.png" alt="&quot;&quot;"><br><img src="/images/git5.png" alt="&quot;&quot;"><br><img src="/images/git6.png" alt="&quot;&quot;"><br>另：git分布式版本控制系统，Linux内核开发者所写。</p>
<p>###Q&amp;A<br>Q：基础上传项目顺序<br>A：项目文档右键git bash后 ==&gt; git init(设为仓库) ==&gt; git add .(添加到暂存区,.可以替换为具体文件) ==&gt; git commit -m “something”(统一提交更改) ==&gt; git remote add origin <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:losthank(连接远程库) ==&gt; git push -u origin master(推送到远程库)</p>
<p>Q：push到远程库时出现”failed to push refs to ‘git@github…’”字样<br>A：可强制推送，使用git push -u origin master -f即可。但是协同合作时不建议使用。</p>
<p>Q：git push -u origin master<br>A:upstream上传流（-u），只有第一次推送代码时创建，之后无需-u</p>
<p>Q：修改后再次上传<br>A：重复add commit pull push的过程</p>
<p>Q：.gitignore文件<br>A：vue项目传输到github时，node-modules库会被忽略。</p>
<p>Q：git status和git log<br>A：前者查看是否有文件没有被commit，后者查看commit的历史记录。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/02/css权威指南查漏补缺散记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/02/css权威指南查漏补缺散记/" itemprop="url">css权威指南查漏补缺散记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-02T10:08:42+08:00">
                2018-03-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="学习中"><a href="#学习中" class="headerlink" title="学习中"></a>学习中</h4><p>后代元素和子元素的区别：前者包含后者。表示形式——空格和&gt;</p>
<p>XML中不支持.class写法，故有h1[class=””]{color:red;}类似写法。</p>
<p>伪类选择器：a:visited（静态伪类，改变一次即保持）;a:hover（动态伪类）;input:focus{}用于设置选中输入框准备输入时的样式，比如设置背景为银色等。<br>:first-child :nth-child(n)<br>:lang(de)语言<br>伪元素选择器： :first-letter/line  :before/after</p>
<p>color:red !important;重要标记的规则不会被覆盖</p>
<p>web安全颜色：按照不同表示法，分别有能被20%整除的数（如rgb(40%,0,80%)）、0或被51整除的数（如rgb(0,204,153)）、三元组（00 33 66 99 CC FF）。这些在256色计算机系统上可以避免颜色抖动。</p>
<p>段落首行缩进：text-indent:3em</p>
<p>上下标：vertical-align:sub/super。当然之前常用的是middle实现垂直居中。</p>
<p>white-space的属性值影响空白符、换行符、自动换行等。</p>
<p>auto:width margin的left right可以设置。根据父元素宽度自动计算，即比如margin padding等宽度已知，设置width为auto，auto值即为计算得出。如果手动设置的margin left+right+width不为父元素宽度，则right自动调整为计算值。<br>设置left right均为auto，会设置相等的宽度，即居中。</p>
<p>（非）替换元素：浏览器是否根据属性替换内容，如img input等。</p>
<p>行间距 line-height font-size三个区别：行高-font-size等于行间距<br>行框 行内框：行框高度取同一行最高行内框的高度；行内框高度即为line-height</p>
<p>BFC 还有IFC（行内级的）<br>块级元素排布的规则，规定子元素如何定位以及同级元素如何排布。<br>在生成BFC后（float absolute inline-block flex overflow不为visible等） 垂直排布，两个BFC块之间的margin不会发生重叠。其实许多都是常用的。IE的haslayout属性，是IE内置的布局属性，对于不支持BFC的可以调用。</p>
<p><strong>数据属性</strong><br>HTML中<article id="test" data-columns="3" data-parent="xx"><br>这些属性没有可视化展现意义，js读取时，可以使用document.getElementById(‘#test’).dataset.columns = “4”</article></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/01/百度地图API调用学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/01/百度地图API调用学习/" itemprop="url">百度地图API调用学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-01T10:08:42+08:00">
                2018-03-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="百度地图实践中…"><a href="#百度地图实践中…" class="headerlink" title="百度地图实践中…"></a>百度地图实践中…</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">var map = new BMap.Map(&quot;container&quot;);</span><br><span class="line">var point = new BMap.Point(116.404,39.915);</span><br><span class="line">var opts = &#123;offset:new BMap.Size(150,18)&#125;;</span><br><span class="line">var mapStyle = &#123;style:&quot;hardedge&quot;&#125;;//设置界面风格。自定义风格可设置颜色等生成JSON。</span><br><span class="line">var marker = new BMap.Marker(point);//添加标注点</span><br><span class="line">map.addOverlay(marker);</span><br><span class="line">marker.enableDragging();</span><br><span class="line">marker.addEventListener(&apos;dragend&apos;,function(e)&#123;</span><br><span class="line">	alert(&apos;当前位置&apos;+e.point.lng+&apos;,&apos;+e.point.lat);//拖拽时显示相应坐标</span><br><span class="line">  &#125;)</span><br><span class="line">map.setMapStyle(mapStyle);</span><br><span class="line">map.centerAndZoom(point,13);//地图级别，数字越小尺度越大。point为中心点</span><br><span class="line">map.enableScrollWheelZoom(true);</span><br><span class="line">map.addControl(new BMap.NavigationControl());//添加平移缩放控件</span><br><span class="line">	//若改变缩放控件的外观，定义一个opts对象&#123;type:BMAP_NAVIGATION_CONTROL_SMALL&#125;即可</span><br><span class="line">map.addControl(new BMap.ScaleControl(opts));//添加比例尺控件，opts设置偏移像素位置</span><br><span class="line">	/*window.setTimeout(function()&#123;</span><br><span class="line">		map.panTo(new BMap.Point(116.109,39.918))</span><br><span class="line">	&#125;,2000);*/</span><br><span class="line">	//自定义控件</span><br><span class="line">class ZoomControl extends BMap.Control&#123;</span><br><span class="line">	constructor() &#123;</span><br><span class="line">			super();//继承父</span><br><span class="line">			this.defaultAnchor = BMAP_ANCHOR_TOP_LEFT;</span><br><span class="line">		this.defaultOffset = new BMap.Size(100,10);</span><br><span class="line">		&#125;</span><br><span class="line">    initialize(map)&#123;      </span><br><span class="line">        var div = document.createElement(&quot;div&quot;);      </span><br><span class="line">        div.appendChild(document.createTextNode(&quot;放大2级&quot;));    </span><br><span class="line">        gotCss(div);</span><br><span class="line">        // 绑定事件，点击一次放大两级    </span><br><span class="line">        div.onclick = function(e)&#123;  </span><br><span class="line">        map.zoomTo(map.getZoom() + 2);    </span><br><span class="line">        &#125;    </span><br><span class="line">    // 添加DOM元素到地图中   </span><br><span class="line">        map.getContainer().appendChild(div);    </span><br><span class="line">        return div;    </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">function gotCss(div)&#123;</span><br><span class="line">    div.style.cursor = &quot;pointer&quot;;    </span><br><span class="line">    div.style.border = &quot;1px solid gray&quot;;    </span><br><span class="line">    div.style.backgroundColor = &quot;white&quot;; </span><br><span class="line">	return div;</span><br><span class="line">	&#125;</span><br><span class="line">var myZoomCtrl1 = new ZoomControl();</span><br><span class="line">var myZoomCtrl2 = new ZoomControl();</span><br><span class="line">myZoomCtrl2.defaultOffset = new BMap.Size(200,60);</span><br><span class="line">map.addControl(myZoomCtrl1);</span><br><span class="line">map.addControl(myZoomCtrl2);</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/27/vue公共组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hank's House">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/27/vue公共组件/" itemprop="url">vue公共组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-27T02:08:42+08:00">
                2018-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>####实例1:按钮封装<br>正常思路是使用slot实现可复用组件（比如确定等字样的更改）<br>什么情况使用render？<br>示例:<br>export default {<br>    name:’base-button’,//this will be shown in components tree<br>    render(h) {<br>       return h(‘a’,<br>       {<br>           class:[‘button’]<br>       },<br>       this.$slots.default)<br>    }<br>}<br>子组件样式的slot配合props：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div :class=&quot;classes&quot;&gt;</span><br><span class="line">&lt;slot&gt;default&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">props:[&apos;type&apos;]</span><br><span class="line">computed:&#123;</span><br><span class="line">    classes()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            &apos;success&apos;:this.type===&apos;success&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.success&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><br>至于slot是按钮还是文本，就是在父组件中操作啦。<br>动态更新的话，要么在父组件中使用 :slot动态改变选择的slot的name，要么直接在公共组件中动态绑定name。<br>真*实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;div id=&quot;modal&quot; v-show=&apos;show&apos;&gt;</span><br><span class="line">    &lt;p class=&quot;modal-topic&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;span type=&quot;button&quot; :class=&quot;btnStyle&quot; @click=&quot;sure&quot;&gt;&lt;/span&gt;</span><br><span class="line">    &lt;span type=&quot;button&quot; @click=&quot;cancel&quot;&gt;&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div id=&quot;shadow&quot; v-show=&quot;show&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">return &#123;</span><br><span class="line">btnStyle:&apos;grey&apos;,//可props传递为动态</span><br><span class="line">show:true</span><br><span class="line">&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">props:&#123;//或者写成对象形式，使用computed得出该对象</span><br><span class="line">topic:String,</span><br><span class="line">btnText1:String,</span><br><span class="line">btnText2:String</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        sure()&#123;</span><br><span class="line">            this.$emit(&apos;sure&apos;);</span><br><span class="line">        &#125;,</span><br><span class="line">        cancel()&#123;</span><br><span class="line">            this.$emit(&apos;cancel&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.grey&#123;</span><br><span class="line">    color:red;</span><br><span class="line">&#125;</span><br><span class="line">#modal&#123;</span><br><span class="line">    background-color:aquamarine;</span><br><span class="line">    width: 250px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left:50%;</span><br><span class="line">    transform:translate(-50%,-50%);</span><br><span class="line">    box-shadow: 10px 10px 5px #888888;</span><br><span class="line">    padding:10px 0 20px 0;</span><br><span class="line">    z-index: 99;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">&#125;</span><br><span class="line">#shadow&#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    top: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    background-color: grey;</span><br><span class="line">    z-index:55;</span><br><span class="line">    opacity: 0.5;</span><br><span class="line">    filter: blur(25px);</span><br><span class="line">&#125;</span><br><span class="line">span&#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    margin-bottom:0;</span><br><span class="line">    padding:5px 6px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    border: 1px solid transparent;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    color: #333;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    border-color: #ccc;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">&lt;test :topic=&quot;topic&quot; :btnText1=&quot;text1&quot; :btnText2=&quot;text2&quot; @sure=&quot;sure&quot; @cancel=&quot;cancel&quot; ref=&quot;test&quot;&gt;&lt;/test&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default&#123;</span><br><span class="line">  name: &apos;app&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    topic:&apos;您拨打的用户已关机，请稍后再拨您拨打的用户已关机，请稍后再拨您拨打的用户已关机，请稍后再拨&apos;,</span><br><span class="line">    text1:&apos;sure&apos;,</span><br><span class="line">    text2:&apos;cancel&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">components:&#123;</span><br><span class="line">  test</span><br><span class="line">  &#125;,</span><br><span class="line">methods:&#123;</span><br><span class="line">  sure()&#123;</span><br><span class="line">&#125;,</span><br><span class="line">  cancel()&#123;</span><br><span class="line">    this.$refs.test.show = false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>注意遮罩层。<br>我们可能需要在一个嵌套了很多层的子组件里面触发modal。这种情况下，你应该把modal放在根组件里面，然后从子组件触发一个事件上去。<br>效果图：<br><img src="/images/modal.png" alt="&quot;&quot;"></p>
<p>####实例2：tab标签</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Hank</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hank</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
